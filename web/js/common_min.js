document.domain="115.com";
$(document).ready(function(){getLoginInfo();var a=!1;$("#js_sub_menu").find("a.arrow").click(function(){$("#js_sub_menu li").removeClass("active");$(this).parent().addClass("active");$("#js_sub_menu_list").show();$.getJSON("/ajax_request/get_mine_groups?callback=?",function(b){var a="",d=b.data;if(b.status==0)a='<div style="padding-top:120px;line-height:24px;color:#808080;text-align:center;"><p>'+d+"</p></div>";else{var a="<dl>",b=d.created.length,c=d.joined.length;if(b>0){a+='<dt><i class="date">\u521b\u5efa\u65e5\u671f</i><i class="title">\u6211\u521b\u5efa\u7684\u5708\u5b50</i></dt>';
for(var e=0;e<b;e++)a+='<dd><i class="date">'+d.created[e].create_time+'</i><a href="/group/'+d.created[e].gid+'" class="title">'+d.created[e].name+"</a></dd>"}if(c>0){a+='<dt><i class="date">\u52a0\u5165\u65e5\u671f</i><i class="title">\u6211\u52a0\u5165\u7684\u5708\u5b50</i></dt>';for(e=0;e<c;e++)a+='<dd><i class="date">'+d.joined[e].join_time+'</i><a href="/group/'+d.joined[e].gid+'" class="title">'+d.joined[e].name+"</a></dd>"}a+="</dl>"}$("#js_sub_menu_list").html(a)})});$("#js_sub_menu_list,#js_sub_menu a.arrow").hover(function(){a=
!0},function(){a=!1});$(document).bind("click",function(){a||($("#js_sub_menu li").removeClass("active"),$("#js_sub_menu_list").hide())});$("#btn-submit").click(function(){$(this).parents("form").submit();return!1});Util.TextBox.BindDefaultText($("#js_search_key"),"\u641c\u7d22\u5708\u5b50");$("#js_search_form").submit(function(){var a=$("#js_search_key");if(a.val()=="\u641c\u7d22\u5708\u5b50"||a.val()=="")return a.focus(),!1})});
var currURL=encodeURIComponent(window.location.href),getLoginInfo=function(){var a=$("#js_u_info"),b=a.children("li.line");$.ajax({url:"/ajax_request/get_login_info",type:"get",dataType:"jsonp",async:!1,success:function(f){if(f.status>0){var d=f.data.user_name,f=f.data.email,c="";b.length?(c+='<li><a href="javascript:doAction();" class="sub-link" title="\u8bbf\u95ee\u4e2a\u4eba\u4e2d\u5fc3">'+d+"&lt;"+f+"&gt;</a></li>",c+='<li><a href="javascript:doAction(\'logout\');" class="sub-link">\u9000\u51fa</a></li>',
c+='<li class="line">|</li>',c+='<li rel="sub-nav">',c+='<a href="javascript:showMsg();" class="sub-link arrow" id="msgs_total">\u6d88\u606f</i><s></s></a>',c+='<div class="info-list">',c+='<a href="javascript:showMsg();" id="msgs_inbox">\u7ad9\u5185\u77ed\u4fe1</a>',c+='<a href="javascript:showMsg(\'?c=active&app=g\');" id="msgs_active">\u4e92\u52a8\u6d88\u606f</a>',c+='<a href="javascript:showMsg(\'?c=notice\');" id="msgs_notice">\u7cfb\u7edf\u901a\u77e5</a>',c+="</div></li>",$(c).insertBefore(b).filter("[rel]").hover(function(){$(this).addClass("active")},
function(){$(this).removeClass("active")}),getMsgCount()):a.html("<li>\u6b22\u8fce\u60a8\uff0c"+d+"\uff01</li>")}else b.length?$('<li>\u6b22\u8fce\u60a8\u8bbf\u95ee115\u5708\u5b50, \u8bf7\u5148<a href="javascript:;" onclick="doAction(\'login\')" class="sub-link">\u767b\u5f55</a></li>').insertBefore(b):a.html("<li>\u6b22\u8fce\u60a8\uff0c\u6e38\u5ba2\uff01</li>")}})},getMsgCount=function(){$.getScript(URL_MSG+"?ac=unread&js_return=msgs",function(){if(typeof msgs=="object"){var a=0,b;for(b in msgs){var f=
parseInt(msgs[b]);f>0&&($("#msgs_"+b).append('(<i class="imp" >'+f+"</i>)"),a+=parseInt(msgs[b]))}a>0&&$("#msgs_total").append('(<i class="imp" >'+a+"</i>)")}})},doAction=function(a){var b=[];b.login=URL_PASSPORT+"?ac=login&goto="+currURL;b.logout=URL_PASSPORT+"?ac=logout&goto="+URL;window.location=b[a]?b[a]:URL_MY},showMsg=function(a){Util.MsgBox.IframeBox({url:URL_MSG+(a?a:""),width:"800",height:"530"})};
